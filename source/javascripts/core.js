(function(){this.bound_elements={sliders:{}},this.slider=function(t,e){return this.bound_elements.sliders[t]=t,t.addEventListener("click",function(t){return e(t.offsetX)}),t._move_listener=function(i){return t._mouse_downed?e(i.pageX-t.getBoundingClientRect().left):void 0},t.addEventListener("mousedown",function(){return this._mouse_downed=!0,document.addEventListener("mousemove",this._move_listener),document.addEventListener("mouseup",function(){return t._mouse_downed=void 0,document.removeEventListener("mousemove",this._move_listener)})})}}).call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){function t(t,i,n){var o=this;this.element=t,this.window=null!=i?i:i,this.document=null!=n?n:n,this.header_padding=e(this.header_padding,this),this.header_height=e(this.header_height,this),this.window_height=e(this.window_height,this),this.element.style.width="100%",this.element.style.height=this.full_height(),this.window.onresize=function(){return o.element.style.height=o.full_height()}}return t.prototype.window_height=function(){return this.window.innerHeight?this.window.innerHeight:this.document.documentElement.offsetHeight},t.prototype.header_height=function(){var t;return t=this.document.getElementsByClassName("mod-header")[0],t.offsetHeight?t.offsetHeight:this.document.defaultView.getComputedStyle(t).getPropertyValue("height")},t.prototype.header_padding=function(){var t;return t=this.document.getElementsByClassName("mod-header")[0].children[0],t.offsetHeight?t.offsetHeight:this.document.defaultView.getComputedStyle(t).getPropertyValue("height")},t.prototype.full_height=function(){return this.window_height()-this.header_height()-(this.header_height()-this.header_padding())+"px"},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).FullHeight=t}.call(this),function(){var t;t=function(){function t(t){null==t&&(t=0),this.set(t)}return t.prototype.set=function(t){return this.timecode=t,this.hours=Math.floor(this.timecode/36e5),this.minutes=Math.floor((this.timecode-Math.floor(36e5*this.hours))/6e4),this.seconds=Math.floor((this.timecode-Math.floor(36e5*this.hours+6e4*this.minutes))/1e3),this.centis=Math.round((this.timecode-Math.floor(36e5*this.hours+6e4*this.minutes+1e3*this.seconds))/10)},t.prototype.display=function(){var t;return t=function(t){return 10>t?"0"+t:t},this.hours+":"+t(this.minutes)+":"+t(this.seconds)+":"+t(this.centis)},t.prototype.time_from=function(t){return new Date(t.getTime()+this.timecode)},t.prototype.increment=function(t){return this.set(this.timecode+t)},t.prototype.progress=function(t){return this.timecode/t},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).TimeCode=t}.call(this),function(){var t;t=function(){function t(t,e){this.lat=t,this.lng=e}var e;return e=function(t,e,i){var n,o,r,a,s;return n=Math.abs(t),o=Math.floor(n),r=Math.floor(60*(n-o)),a=3600*(n-o-r/60),s=t>=0?e:i,""+o+"&deg; "+r+"' "+a.toFixed(1)+'" '+s},t.prototype.latitude=function(){return e(this.lat,"N","S")},t.prototype.longitude=function(){return e(this.lng,"E","W")},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).LatitudeLongitude=t}.call(this),function(){var t;t=function(){function t(t,e){var i,n,o,r,a,s;a=(e.lat-t.lat)*(Math.PI/180),s=(e.lng-t.lng)*(Math.PI/180),o=t.lat*(Math.PI/180),r=e.lat*(Math.PI/180),i=Math.sin(a/2)*Math.sin(a/2)+Math.sin(s/2)*Math.sin(s/2)*Math.cos(o)*Math.cos(r),n=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),this.nm=3443.89849*n}return t.prototype.to_nm=function(){return this.nm},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).DistanceBetween=t}.call(this),function(){var t;t=function(){function t(t,e,i,n){var o,r,a;null==n&&(n=DistanceBetween),o=new n(i,e).to_nm(),r=new n(t,i).to_nm(),a=new n(t,e).to_nm(),this._rad=Math.acos((o*o+r*r-a*a)/(2*o*r))}return t.prototype.to_rad=function(){return this._rad},t.prototype.to_deg=function(){return 180*this._rad/Math.PI},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).InnerAngleOfTriangle=t}.call(this),function(){var t;t=function(){function t(t,e,i){this.player=t,this.display=e,this.time_code=null!=i?i:TimeCode,this.start=this.player.start_time().getTime(),this.max=this.player.finish_time().getTime()-this.start,this.current=new this.time_code,this.player.set_to(this.current)}return t.prototype.tick=function(t){var e;return e=t-this.last,this.current.increment(e),this.current.timecode<this.max?(this.player.set_to(this.current),this.display.set_to(this.current,this.current.progress(this.max)),this.last=t):(this.end(),clearInterval(this.timer))},t.prototype.end=function(){var t;return t=new this.time_code(this.max),this.player.set_to(t),this.display.set_to(t,1),this.current=new this.time_code(0)},t.prototype.skip=function(t){var e;return e=this.display.calculate(t),this.current=new this.time_code(this.max*e),this.player.set_to(this.current),this.display.set_to(this.current,e)},t.prototype.play=function(){var t=this;return this.display.playing(),this.last=(new Date).getTime(),this.timer=setInterval(function(){return t.tick((new Date).getTime())},100),this.tick(this.last)},t.prototype.pause=function(){return this.display.stopped(),clearInterval(this.timer)},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).Controls=t}.call(this),function(){var t;t=function(){function t(t){this.dom=null!=t?t:document}return t.prototype.set_to=function(t){return this.dom.getElementById("playback_time").innerHTML=t.display()},t.prototype.playing=function(){return this.dom.getElementById("play").innerHTML="||",this.dom.getElementById("play").onclick=function(){return controls.pause()}},t.prototype.stopped=function(){return this.dom.getElementById("play").innerHTML="&#9654;",this.dom.getElementById("play").onclick=function(){return controls.play()}},t.prototype.calculate=function(t){var e;return e=t/this.dom.getElementById("progress_bar").parentNode.offsetWidth,e>1?1:0>e?0:e},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).Display=t}.call(this),function(){var t;t=function(){function t(t,e,i){this.marks=t,this.angle=null!=e?e:InnerAngleOfTriangle,this.distance=null!=i?i:DistanceBetween,this.mark_passes=[]}return t.prototype.angle_of_position_at=function(t,e){return new this.angle(t,this.marks[e-1],this.marks[e],this.distance).to_deg()},t.prototype.inner_angle_at=function(t){return new this.angle(this.marks[t-1],this.marks[t+1],this.marks[t],this.distance).to_deg()},t.prototype.boundary_angle_at=function(t){return(360-this.inner_angle_at(t))/2},t.prototype.load=function(t){var e,i=this;return this.track=t,e=1,this.track.forEach(function(t){return i.marks.length-1>e&&i.boundary_angle_at(e)<i.angle_of_position_at(t,e)?(i.mark_passes.push(t.time),e++):void 0})},t.prototype.next_mark_at=function(t){var e,i;for(i=this.track[t-1],e=0;this.mark_passes[e]<=i.time;)e++;return this.marks[e+1]},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).Course=t}.call(this),function(){var t,e;e=function(){function t(t,e,i,n){var o;this.api=t,this.map=e,this.points=i,this.options=null!=n?n:{},(o=this.options).colour||(o.colour="blue"),this.actual=new this.api.Polyline({strokeColor:this.options.colour,strokeOpacity:1,strokeWeight:2.5,map:this.map})}return t.prototype.set_to=function(t){return this.actual.setPath(this.points.slice(0,t))},t}(),t=function(){function t(t,e){this.element=t,this.api=null!=e?e:google.maps,this.actual=new this.api.Map(this.element,{zoom:13,mapTypeId:this.api.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1}),this.tracks=[]}return t.prototype.load=function(t,i){var n,o=this;return null==i&&(i={}),t.length>0?(t=t.map(function(t){return new o.api.LatLng(t.lat,t.lng)}),(null==i.center||i.center)&&this.actual.setCenter(t[0]),n=new this.api.LatLngBounds,t.forEach(function(t){return n.extend(t)}),this.actual.fitBounds(n),this.tracks.push(new e(this.api,this.actual,t,i))):void 0},t.prototype.set=function(t){var e,i,n,o,r;for(o=this.tracks,r=[],i=0,n=o.length;n>i;i++)e=o[i],r.push(e.set_to(t));return r},t.prototype.mark=function(t,e,i){return null==i&&(i={}),i.map=this.actual,i.position=new this.api.LatLng(t,e),new this.api.Marker(i)},t.prototype.line=function(t){return t.map=this.actual,new this.api.Polyline(t)},t.prototype.icon=function(t,e){var i;return i=new this.api.MarkerImage(t),e.anchor&&(i.anchor=new this.api.Point(e.anchor[0],e.anchor[1])),i},t.prototype.on=function(t,e,i){var n;return n=e?e.ui:this.actual,this.api.event.addListener(n,t,function(t){var e;return e=t.latLng,i({lat:e.lat(),lng:e.lng()})})},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).Map=t}.call(this),function(){var t;t=function(){function t(t,i,n){null==t&&(t=document),this.format=null!=i?i:e,this.latlng=null!=n?n:LatitudeLongitude,this.display=t.getElementById("course")}var e;return e=function(t,e,i){return"<div class='latitude'> "+i.latitude()+"</div>"+("<div class='longitude'>"+i.longitude()+"</div>")+("<div class='heading'>  "+t+"&deg;</div>")+("<div class='speed'>    "+e+"knts</div>")},t.prototype.load=function(t){this.track=t},t.prototype.set=function(t){var e,i,n;return e=this.track[t-1],i=e.cog&&e.cog>=0?e.cog.toFixed(1):"---.-",n=e.sog&&e.sog>=0?(1.94384449*e.sog).toFixed(1):"--.-",this.display.innerHTML=this.format(i,n,new this.latlng(e.lat,e.lng))},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).YachtStatistics=t}.call(this),function(){var t;t=function(){function t(t,i){null==t&&(t=document),this.format=null!=i?i:e,this.display=t.getElementById("wind")}var e;return e=function(t,e){return"<tr><th>TWA</th><td>"+t+"&deg;</td></tr>"+("<tr><th>TWS</th><td>"+e+"knts</td></tr>")},t.prototype.load=function(t){this.track=t},t.prototype.set=function(t){var e,i,n;return e=this.track[t-1],n=e.wind_speed&&e.wind_speed>=0?(.868976*e.wind_speed).toFixed(1):"--.-",i=e.wind_bearing&&e.wind_bearing>=0?e.wind_bearing.toFixed(1):"---.-",this.display.innerHTML=this.format(i,n)},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).WindStatistics=t}.call(this),function(t){t.color={},t.color.make=function(e,i,n,o){var r={};return r.r=e||0,r.g=i||0,r.b=n||0,r.a=null!=o?o:1,r.add=function(t,e){for(var i=0;t.length>i;++i)r[t.charAt(i)]+=e;return r.normalize()},r.scale=function(t,e){for(var i=0;t.length>i;++i)r[t.charAt(i)]*=e;return r.normalize()},r.toString=function(){return r.a>=1?"rgb("+[r.r,r.g,r.b].join(",")+")":"rgba("+[r.r,r.g,r.b,r.a].join(",")+")"},r.normalize=function(){function t(t,e,i){return t>e?t:e>i?i:e}return r.r=t(0,parseInt(r.r),255),r.g=t(0,parseInt(r.g),255),r.b=t(0,parseInt(r.b),255),r.a=t(0,r.a,1),r},r.clone=function(){return t.color.make(r.r,r.b,r.g,r.a)},r.normalize()},t.color.extract=function(e,i){var n;do{if(n=e.css(i).toLowerCase(),""!=n&&"transparent"!=n)break;e=e.parent()}while(!t.nodeName(e.get(0),"body"));return"rgba(0, 0, 0, 0)"==n&&(n="transparent"),t.color.parse(n)},t.color.parse=function(i){var n,o=t.color.make;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(i))return o(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10));if(n=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return o(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4]));if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(i))return o(2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3]));if(n=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return o(2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3]),parseFloat(n[4]));if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(i))return o(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16));if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(i))return o(parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16));var r=t.trim(i).toLowerCase();return"transparent"==r?o(255,255,255,0):(n=e[r]||[0,0,0],o(n[0],n[1],n[2]))};var e={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(t){function e(e,i,n,o){function r(t,e){for(var e=[K].concat(e),i=0;t.length>i;++i)t[i].apply(this,e)}function a(e){for(var i=[],n=0;e.length>n;++n){var o=t.extend(!0,{},N.series);null!=e[n].data?(o.data=e[n].data,delete e[n].data,t.extend(!0,o,e[n]),e[n].data=o.data):o.data=e[n],i.push(o)}for(B=i,n=B.length,e=i=0;B.length>e;++e)o=B[e].color,null!=o&&(n--,"number"==typeof o&&o>i&&(i=o));i>n&&(n=i+1);for(var i=[],a=N.colors,h=a.length,c=0,e=0;n>e;e++)o=t.color.parse(a[e%h]||"#666"),0==e%h&&e&&(c=c>=0?.5>c?-c-.2:0:-c),i[e]=o.scale("rgb",1+c);for(e=n=0;B.length>e;++e){if(o=B[e],null==o.color?(o.color=i[n].toString(),++n):"number"==typeof o.color&&(o.color=i[o.color].toString()),null==o.lines.show){var p,a=!0;for(p in o)if(o[p]&&o[p].show){a=!1;break}a&&(o.lines.show=!0)}o.xaxis=u(X,s(o,"x")),o.yaxis=u(q,s(o,"y"))}p=function(t,e,i){t.datamin>e&&e!=-y&&(t.datamin=e),i>t.datamax&&i!=y&&(t.datamax=i)};var d,f,m,g=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,y=Number.MAX_VALUE;for(t.each(l(),function(t,e){e.datamin=g,e.datamax=x,e.used=!1}),e=0;B.length>e;++e)i=B[e],i.datapoints={points:[]},r($.processRawData,[i,i.data,i.datapoints]);for(e=0;B.length>e;++e){var i=B[e],v=i.data,b=i.datapoints.format;if(b||(b=[],b.push({x:!0,number:!0,required:!0}),b.push({y:!0,number:!0,required:!0}),(i.bars.show||i.lines.show&&i.lines.fill)&&(b.push({y:!0,number:!0,required:!1,defaultValue:0}),i.bars.horizontal&&(delete b[b.length-1].y,b[b.length-1].x=!0)),i.datapoints.format=b),null==i.datapoints.pointsize)for(i.datapoints.pointsize=b.length,h=i.datapoints.pointsize,a=i.datapoints.points,insertSteps=i.lines.show&&i.lines.steps,i.xaxis.used=i.yaxis.used=!0,n=d=0;v.length>n;++n,d+=h){m=v[n];var k=null==m;if(!k)for(o=0;h>o;++o)c=m[o],(f=b[o])&&(f.number&&null!=c&&(c=+c,isNaN(c)?c=null:1/0==c?c=y:-1/0==c&&(c=-y)),null==c&&(f.required&&(k=!0),null!=f.defaultValue&&(c=f.defaultValue))),a[d+o]=c;if(k)for(o=0;h>o;++o)c=a[d+o],null!=c&&(f=b[o],f.x&&p(i.xaxis,c,c),f.y&&p(i.yaxis,c,c)),a[d+o]=null;else if(insertSteps&&d>0&&null!=a[d-h]&&a[d-h]!=a[d]&&a[d-h+1]!=a[d+1]){for(o=0;h>o;++o)a[d+h+o]=a[d+o];a[d+1]=a[d-h+1],d+=h}}}for(e=0;B.length>e;++e)i=B[e],r($.processDatapoints,[i,i.datapoints]);for(e=0;B.length>e;++e){for(i=B[e],a=i.datapoints.points,h=i.datapoints.pointsize,b=i.datapoints.format,m=d=g,k=v=x,n=0;a.length>n;n+=h)if(null!=a[n])for(o=0;h>o;++o)c=a[n+o],!(f=b[o])||c==y||c==-y||(f.x&&(d>c&&(d=c),c>v&&(v=c)),f.y&&(m>c&&(m=c),c>k&&(k=c)));if(i.bars.show){switch(i.bars.align){case"left":n=0;break;case"right":n=-i.bars.barWidth;break;case"center":n=-i.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+i.bars.align)}i.bars.horizontal?(m+=n,k+=n+i.bars.barWidth):(d+=n,v+=n+i.bars.barWidth)}p(i.xaxis,d,v),p(i.yaxis,m,k)}t.each(l(),function(t,e){e.datamin==g&&(e.datamin=null),e.datamax==x&&(e.datamax=null)})}function s(t,e){var i=t[e+"axis"];return"object"==typeof i&&(i=i.n),"number"!=typeof i&&(i=1),i}function l(){return t.grep(X.concat(q),function(t){return t})}function h(t){var e,i,n={};for(e=0;X.length>e;++e)(i=X[e])&&i.used&&(n["x"+i.n]=i.c2p(t.left));for(e=0;q.length>e;++e)(i=q[e])&&i.used&&(n["y"+i.n]=i.c2p(t.top));return void 0!==n.x1&&(n.x=n.x1),void 0!==n.y1&&(n.y=n.y1),n}function u(e,i){return e[i-1]||(e[i-1]={n:i,direction:e==X?"x":"y",options:t.extend(!0,{},e==X?N.xaxis:N.yaxis)}),e[i-1]}function c(t){return window.devicePixelRatio>1&&(void 0===t.webkitBackingStorePixelRatio||2>t.webkitBackingStorePixelRatio)?window.devicePixelRatio:1}function p(i,n){var o=document.createElement("canvas");o.className=n,o.getContext||(o=window.G_vmlCanvasManager.initElement(o));var r=o.getContext("2d"),a=c(r);return o.width=j*a,o.height=U*a,o.style.width=j+"px",o.style.height=U+"px",i||t(o).css({position:"absolute",left:0,top:0}),t(o).appendTo(e),r.save(),r.scale(a,a),o}function d(){if(j=e.width(),U=e.height(),0>=j||0>=U)throw Error("Invalid dimensions for plot, width = "+j+", height = "+U)}function f(t){var e=t.getContext("2d"),i=c(e);t.style.width!=j&&(t.width=j*i,t.style.width=j+"px"),t.style.height!=U&&(t.height=U*i,t.style.height=U+"px"),e.restore(),e.save(),e.scale(i,i)}function m(e){var i=e.labelWidth,n=e.labelHeight,o=e.options.position,r=e.options.tickLength,a=N.grid.axisMargin,s=N.grid.labelMargin,l="x"==e.direction?X:q,h=t.grep(l,function(t){return t&&t.options.position==o&&t.reserveSpace});if(t.inArray(e,h)==h.length-1&&(a=0),null==r)var r=t.grep(l,function(t){return t&&t.reserveSpace}),u=0==t.inArray(e,r),r=u?"full":5;isNaN(+r)||(s+=+r),"x"==e.direction?(n+=s,"bottom"==o?(Y.bottom+=n+a,e.box={top:U-Y.bottom,height:n}):(e.box={top:Y.top+a,height:n},Y.top+=n+a)):(i+=s,"left"==o?(e.box={left:Y.left+a,width:i},Y.left+=i+a):(Y.right+=i+a,e.box={left:j-Y.right,width:i})),e.position=o,e.tickLength=r,e.box.padding=s,e.innermost=u}function g(){var i,n=l(),o=N.grid.show;for(i in Y){var a=N.grid.margin||0;Y[i]="number"==typeof a?a:a[i]||0}r($.processOffset,[Y]);for(i in Y)Y[i]+=o?N.grid.borderWidth:0;if(t.each(n,function(t,e){e.show=e.options.show,null==e.show&&(e.show=e.used),e.reserveSpace=e.show||e.options.reserveSpace;var i=e.options,n=+(null!=i.min?i.min:e.datamin),o=+(null!=i.max?i.max:e.datamax),r=o-n;if(0==r)r=0==o?1:.01,null==i.min&&(n-=r),(null==i.max||null!=i.min)&&(o+=r);else{var a=i.autoscaleMargin;null!=a&&(null==i.min&&(n-=r*a,0>n&&null!=e.datamin&&e.datamin>=0&&(n=0)),null==i.max)&&(o+=r*a,o>0&&null!=e.datamax&&0>=e.datamax&&(o=0))}e.min=n,e.max=o}),o){var s={style:e.css("font-style"),size:Math.round(.8*(+e.css("font-size").replace("px","")||13)),variant:e.css("font-variant"),weight:e.css("font-weight"),family:e.css("font-family")},o=t.grep(n,function(t){return t.reserveSpace});for(t.each(o,function(e,i){var n,o=i.options;if(n="number"==typeof o.ticks&&o.ticks>0?o.ticks:.3*Math.sqrt("x"==i.direction?j:U),i.delta=(i.max-i.min)/n,"time"==o.mode&&!i.tickGenerator)throw Error("Time mode requires the flot.time plugin.");if(!i.tickGenerator){n=o.tickDecimals;var r=-Math.floor(Math.log(i.delta)/Math.LN10);null!=n&&r>n&&(r=n);var a,l=Math.pow(10,-r),h=i.delta/l;1.5>h?a=1:3>h?(a=2,h>2.25&&(null==n||n>=r+1)&&(a=2.5,++r)):a=7.5>h?5:10,a*=l,null!=o.minTickSize&&o.minTickSize>a&&(a=o.minTickSize),i.tickDecimals=Math.max(0,null!=n?n:r),i.tickSize=o.tickSize||a,i.tickGenerator=function(t){var e,i=[],n=t.tickSize*Math.floor(t.min/t.tickSize),o=0,r=Number.NaN;do e=r,r=n+o*t.tickSize,i.push(r),++o;while(t.max>r&&r!=e);return i},i.tickFormatter=function(t,e){var i=Math.pow(10,e.tickDecimals);return""+Math.round(t*i)/i}}if(t.isFunction(o.tickFormatter)&&(i.tickFormatter=function(t,e){return""+o.tickFormatter(t,e)}),null!=o.alignTicksWithAxis){var u=("x"==i.direction?X:q)[o.alignTicksWithAxis-1];u&&u.used&&u!=i&&(n=i.tickGenerator(i),n.length>0&&(null==o.min&&(i.min=Math.min(i.min,n[0])),null==o.max&&n.length>1)&&(i.max=Math.max(i.max,n[n.length-1])),i.tickGenerator=function(t){var e,i,n=[];for(i=0;u.ticks.length>i;++i)e=(u.ticks[i].v-u.min)/(u.max-u.min),e=t.min+e*(t.max-t.min),n.push(e);return n},!i.mode&&null==o.tickDecimals&&(n=Math.max(0,-Math.floor(Math.log(i.delta)/Math.LN10)+1),r=i.tickGenerator(i),r.length>1&&/\..*0$/.test((r[1]-r[0]).toFixed(n))||(i.tickDecimals=n)))}for(r=i.options.ticks,n=[],null==r||"number"==typeof r&&r>0?n=i.tickGenerator(i):r&&(n=t.isFunction(r)?r(i):r),i.ticks=[],r=0;n.length>r;++r)h=null,a=n[r],"object"==typeof a?(l=+a[0],a.length>1&&(h=a[1])):l=+a,null==h&&(h=i.tickFormatter(l,i)),isNaN(l)||i.ticks.push({v:l,label:h});n=i.ticks,i.options.autoscaleMargin&&n.length>0&&(null==i.options.min&&(i.min=Math.min(i.min,n[0].v)),null==i.options.max&&n.length>1)&&(i.max=Math.max(i.max,n[n.length-1].v)),i.font=t.extend({},s,i.options.font),n=i.options,r=i.ticks||[],l=n.labelWidth||0,h=n.labelHeight||0,a=i.font,V.save(),V.font=a.style+" "+a.variant+" "+a.weight+" "+a.size+"px '"+a.family+"'";for(var c=0;r.length>c;++c){var p=r[c];if(p.lines=[],p.width=p.height=0,p.label){for(var d=(p.label+"").replace(/<br ?\/?>|\r\n|\r/g,"\n").split("\n"),f=0;d.length>f;++f){var m={text:d[f]},g=V.measureText(m.text);m.width=g.width,m.height=null!=g.height?g.height:a.size,m.height+=Math.round(.15*a.size),p.width=Math.max(m.width,p.width),p.height+=m.height,p.lines.push(m)}null==n.labelWidth&&(l=Math.max(l,p.width)),null==n.labelHeight&&(h=Math.max(h,p.height))}}V.restore(),i.labelWidth=Math.ceil(l),i.labelHeight=Math.ceil(h)}),i=o.length-1;i>=0;--i)m(o[i]);i=N.grid.minBorderMargin;var h={x:0,y:0};if(null==i)for(a=i=0;B.length>a;++a)i=Math.max(i,2*(B[a].points.radius+B[a].points.lineWidth/2));h.x=h.y=Math.ceil(i),t.each(l(),function(t,e){var i=e.direction;e.reserveSpace&&(h[i]=Math.ceil(Math.max(h[i],("x"==i?e.labelWidth:e.labelHeight)/2)))}),Y.left=Math.max(h.x,Y.left),Y.right=Math.max(h.x,Y.right),Y.top=Math.max(h.y,Y.top),Y.bottom=Math.max(h.y,Y.bottom),t.each(o,function(t,e){"x"==e.direction?(e.box.left=Y.left-e.labelWidth/2,e.box.width=j-Y.left-Y.right+e.labelWidth):(e.box.top=Y.top-e.labelHeight/2,e.box.height=U-Y.bottom-Y.top+e.labelHeight)})}if(Q=j-Y.left-Y.right,J=U-Y.bottom-Y.top,t.each(n,function(t,e){var i,n,o=function(t){return t},r=e.options.transform||o,a=e.options.inverseTransform;"x"==e.direction?(i=e.scale=Q/Math.abs(r(e.max)-r(e.min)),n=Math.min(r(e.max),r(e.min))):(i=e.scale=J/Math.abs(r(e.max)-r(e.min)),i=-i,n=Math.max(r(e.max),r(e.min))),e.p2c=r==o?function(t){return(t-n)*i}:function(t){return(r(t)-n)*i},e.c2p=a?function(t){return a(n+t/i)}:function(t){return n+t/i}}),e.find(".legend").remove(),N.legend.show){n=[],o=[],i=!1;for(var u,c,a=N.legend.labelFormatter,p=0;B.length>p;++p)u=B[p],u.label&&(c=a?a(u.label,u):u.label)&&o.push({label:c,color:u.color});if(N.legend.sorted)if(t.isFunction(N.legend.sorted))o.sort(N.legend.sorted);else{var d="descending"!=N.legend.sorted;o.sort(function(t,e){return t.label==e.label?0:t.label<e.label!=d?1:-1})}for(p=0;o.length>p;++p)entry=o[p],0==p%N.legend.noColumns&&(i&&n.push("</tr>"),n.push("<tr>"),i=!0),n.push('<td class="legendColorBox"><div style="border:1px solid '+N.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+entry.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+entry.label+"</td>");i&&n.push("</tr>"),0!=n.length&&(o='<table style="font-size:smaller;color:'+N.grid.color+'">'+n.join("")+"</table>",null!=N.legend.container?t(N.legend.container).html(o):(n="",i=N.legend.position,a=N.legend.margin,null==a[0]&&(a=[a,a]),"n"==i.charAt(0)?n+="top:"+(a[1]+Y.top)+"px;":"s"==i.charAt(0)&&(n+="bottom:"+(a[1]+Y.bottom)+"px;"),"e"==i.charAt(1)?n+="right:"+(a[0]+Y.right)+"px;":"w"==i.charAt(1)&&(n+="left:"+(a[0]+Y.left)+"px;"),o=t('<div class="legend">'+o.replace('style="','style="position:absolute;'+n+";")+"</div>").appendTo(e),0!=N.legend.backgroundOpacity&&(i=N.legend.backgroundColor,null==i&&(i=(i=N.grid.backgroundColor)&&"string"==typeof i?t.color.parse(i):t.color.extract(o,"background-color"),i.a=1,i=i.toString()),a=o.children(),t('<div style="position:absolute;width:'+a.width()+"px;height:"+a.height()+"px;"+n+"background-color:"+i+';"> </div>').prependTo(o).css("opacity",N.legend.backgroundOpacity))))}}function x(){V.clearRect(0,0,j,U),r($.drawBackground,[V]);var t=N.grid;t.show&&t.backgroundColor&&(V.save(),V.translate(Y.left,Y.top),V.fillStyle=L(N.grid.backgroundColor,J,0,"rgba(255, 255, 255, 0)"),V.fillRect(0,0,Q,J),V.restore()),t.show&&!t.aboveData&&(v(),b());for(var e=0;B.length>e;++e){r($.drawSeries,[V,B[e]]);var i=B[e];i.lines.show&&k(i),i.bars.show&&M(i),i.points.show&&w(i)}r($.draw,[V]),t.show&&t.aboveData&&(v(),b())}function y(t,e){for(var i,n,o,r,a=l(),s=0;a.length>s;++s)if(i=a[s],i.direction==e&&(r=e+i.n+"axis",!t[r]&&1==i.n&&(r=e+"axis"),t[r])){n=t[r].from,o=t[r].to;break}return t[r]||(i="x"==e?X[0]:q[0],n=t[e+"1"],o=t[e+"2"]),null!=n&&null!=o&&n>o&&(r=n,n=o,o=r),{from:n,to:o,axis:i}}function v(){var e;V.save(),V.translate(Y.left,Y.top);var i=N.grid.markings;if(i){if(t.isFunction(i)){var n=K.getAxes();n.xmin=n.xaxis.min,n.xmax=n.xaxis.max,n.ymin=n.yaxis.min,n.ymax=n.yaxis.max,i=i(n)}for(e=0;i.length>e;++e){var n=i[e],o=y(n,"x"),r=y(n,"y");null==o.from&&(o.from=o.axis.min),null==o.to&&(o.to=o.axis.max),null==r.from&&(r.from=r.axis.min),null==r.to&&(r.to=r.axis.max),o.to<o.axis.min||o.from>o.axis.max||r.to<r.axis.min||r.from>r.axis.max||(o.from=Math.max(o.from,o.axis.min),o.to=Math.min(o.to,o.axis.max),r.from=Math.max(r.from,r.axis.min),r.to=Math.min(r.to,r.axis.max),o.from==o.to&&r.from==r.to||(o.from=o.axis.p2c(o.from),o.to=o.axis.p2c(o.to),r.from=r.axis.p2c(r.from),r.to=r.axis.p2c(r.to),o.from==o.to||r.from==r.to?(V.beginPath(),V.strokeStyle=n.color||N.grid.markingsColor,V.lineWidth=n.lineWidth||N.grid.markingsLineWidth,V.moveTo(o.from,r.from),V.lineTo(o.to,r.to),V.stroke()):(V.fillStyle=n.color||N.grid.markingsColor,V.fillRect(o.from,r.to,o.to-o.from,r.from-r.to))))}}for(n=l(),i=N.grid.borderWidth,o=0;n.length>o;++o){r=n[o],e=r.box;var a,s,h,u,c=r.tickLength;if(r.show&&0!=r.ticks.length){for(V.strokeStyle=r.options.tickColor||t.color.parse(r.options.color).scale("a",.22).toString(),V.lineWidth=1,"x"==r.direction?(a=0,s="full"==c?"top"==r.position?0:J:e.top-Y.top+("top"==r.position?e.height:0)):(s=0,a="full"==c?"left"==r.position?0:Q:e.left-Y.left+("left"==r.position?e.width:0)),r.innermost||(V.beginPath(),h=u=0,"x"==r.direction?h=Q:u=J,1==V.lineWidth&&(a=Math.floor(a)+.5,s=Math.floor(s)+.5),V.moveTo(a,s),V.lineTo(a+h,s+u),V.stroke()),V.beginPath(),e=0;r.ticks.length>e;++e){var p=r.ticks[e].v;h=u=0,r.min>p||p>r.max||"full"==c&&i>0&&(p==r.min||p==r.max)||("x"==r.direction?(a=r.p2c(p),u="full"==c?-J:c,"top"==r.position&&(u=-u)):(s=r.p2c(p),h="full"==c?-Q:c,"left"==r.position&&(h=-h)),1==V.lineWidth&&("x"==r.direction?a=Math.floor(a)+.5:s=Math.floor(s)+.5),V.moveTo(a,s),V.lineTo(a+h,s+u))}V.stroke()}}i&&(V.lineWidth=i,V.strokeStyle=N.grid.borderColor,V.strokeRect(-i/2,-i/2,Q+i,J+i)),V.restore()}function b(){V.save(),t.each(l(),function(e,i){if(i.show&&0!=i.ticks.length){var n=i.box,o=i.font;for(V.fillStyle=i.options.color,V.font=o.style+" "+o.variant+" "+o.weight+" "+o.size+"px "+o.family,V.textAlign="start",V.textBaseline="middle",o=0;i.ticks.length>o;++o){var r=i.ticks[o];if(r.label&&!(r.v<i.min||r.v>i.max))for(var a,s,l,h=0,u=0;r.lines.length>u;++u)l=r.lines[u],"x"==i.direction?(a=Y.left+i.p2c(r.v)-l.width/2,s="bottom"==i.position?n.top+n.padding:n.top+n.height-n.padding-r.height):(s=Y.top+i.p2c(r.v)-r.height/2,a="left"==i.position?n.left+n.width-n.padding-l.width:n.left+n.padding),s+=l.height/2+h,h+=l.height,t.browser.opera&&(a=Math.floor(a),s=Math.ceil(s-2)),V.fillText(l.text,a,s)}}}),V.restore()}function k(t){function e(t,e,i,n,o){var r=t.points,t=t.pointsize,a=null,s=null;V.beginPath();for(var l=t;r.length>l;l+=t){var h=r[l-t],u=r[l-t+1],c=r[l],p=r[l+1];if(null!=h&&null!=c){if(p>=u&&o.min>u){if(o.min>p)continue;h=(o.min-u)/(p-u)*(c-h)+h,u=o.min}else if(u>=p&&o.min>p){if(o.min>u)continue;c=(o.min-u)/(p-u)*(c-h)+h,p=o.min}if(u>=p&&u>o.max){if(p>o.max)continue;h=(o.max-u)/(p-u)*(c-h)+h,u=o.max}else if(p>=u&&p>o.max){if(u>o.max)continue;c=(o.max-u)/(p-u)*(c-h)+h,p=o.max}if(c>=h&&n.min>h){if(n.min>c)continue;u=(n.min-h)/(c-h)*(p-u)+u,h=n.min}else if(h>=c&&n.min>c){if(n.min>h)continue;p=(n.min-h)/(c-h)*(p-u)+u,c=n.min}if(h>=c&&h>n.max){if(c>n.max)continue;u=(n.max-h)/(c-h)*(p-u)+u,h=n.max}else if(c>=h&&c>n.max){if(h>n.max)continue;p=(n.max-h)/(c-h)*(p-u)+u,c=n.max}(h!=a||u!=s)&&V.moveTo(n.p2c(h)+e,o.p2c(u)+i),a=c,s=p,V.lineTo(n.p2c(c)+e,o.p2c(p)+i)}}V.stroke()}V.save(),V.translate(Y.left,Y.top),V.lineJoin="round";var i=t.lines.lineWidth,n=t.shadowSize;if(i>0&&n>0){V.lineWidth=n,V.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;e(t.datapoints,Math.sin(o)*(i/2+n/2),Math.cos(o)*(i/2+n/2),t.xaxis,t.yaxis),V.lineWidth=n/2,e(t.datapoints,Math.sin(o)*(i/2+n/4),Math.cos(o)*(i/2+n/4),t.xaxis,t.yaxis)}if(V.lineWidth=i,V.strokeStyle=t.color,n=C(t.lines,t.color,0,J)){V.fillStyle=n;for(var r=t.datapoints,n=t.xaxis,o=t.yaxis,a=r.points,r=r.pointsize,s=Math.min(Math.max(0,o.min),o.max),l=0,h=!1,u=1,c=0,p=0;!(r>0&&l>a.length+r);){var l=l+r,d=a[l-r],f=a[l-r+u],m=a[l],g=a[l+u];if(h){if(r>0&&null!=d&&null==m){p=l,r=-r,u=2;continue}if(0>r&&l==c+r){V.fill(),h=!1,r=-r,u=1,l=c=p+r;continue}}if(null!=d&&null!=m){if(m>=d&&n.min>d){if(n.min>m)continue;f=(n.min-d)/(m-d)*(g-f)+f,d=n.min}else if(d>=m&&n.min>m){if(n.min>d)continue;g=(n.min-d)/(m-d)*(g-f)+f,m=n.min}if(d>=m&&d>n.max){if(m>n.max)continue;f=(n.max-d)/(m-d)*(g-f)+f,d=n.max}else if(m>=d&&m>n.max){if(d>n.max)continue;g=(n.max-d)/(m-d)*(g-f)+f,m=n.max}if(h||(V.beginPath(),V.moveTo(n.p2c(d),o.p2c(s)),h=!0),f>=o.max&&g>=o.max)V.lineTo(n.p2c(d),o.p2c(o.max)),V.lineTo(n.p2c(m),o.p2c(o.max));else if(o.min>=f&&o.min>=g)V.lineTo(n.p2c(d),o.p2c(o.min)),V.lineTo(n.p2c(m),o.p2c(o.min));else{var x=d,y=m;g>=f&&o.min>f&&g>=o.min?(d=(o.min-f)/(g-f)*(m-d)+d,f=o.min):f>=g&&o.min>g&&f>=o.min&&(m=(o.min-f)/(g-f)*(m-d)+d,g=o.min),f>=g&&f>o.max&&o.max>=g?(d=(o.max-f)/(g-f)*(m-d)+d,f=o.max):g>=f&&g>o.max&&o.max>=f&&(m=(o.max-f)/(g-f)*(m-d)+d,g=o.max),d!=x&&V.lineTo(n.p2c(x),o.p2c(f)),V.lineTo(n.p2c(d),o.p2c(f)),V.lineTo(n.p2c(m),o.p2c(g)),m!=y&&(V.lineTo(n.p2c(m),o.p2c(g)),V.lineTo(n.p2c(y),o.p2c(g)))}}}}i>0&&e(t.datapoints,0,0,t.xaxis,t.yaxis),V.restore()}function w(t){function e(t,e,i,n,o,r,a,s){for(var l=t.points,t=t.pointsize,h=0;l.length>h;h+=t){var u=l[h],c=l[h+1];null==u||r.min>u||u>r.max||a.min>c||c>a.max||(V.beginPath(),u=r.p2c(u),c=a.p2c(c)+n,"circle"==s?V.arc(u,c,e,0,o?Math.PI:2*Math.PI,!1):s(V,u,c,e,o),V.closePath(),i&&(V.fillStyle=i,V.fill()),V.stroke())}}V.save(),V.translate(Y.left,Y.top);var i=t.points.lineWidth,n=t.shadowSize,o=t.points.radius,r=t.points.symbol;i>0&&n>0&&(n/=2,V.lineWidth=n,V.strokeStyle="rgba(0,0,0,0.1)",e(t.datapoints,o,null,n+n/2,!0,t.xaxis,t.yaxis,r),V.strokeStyle="rgba(0,0,0,0.2)",e(t.datapoints,o,null,n/2,!0,t.xaxis,t.yaxis,r)),V.lineWidth=i,V.strokeStyle=t.color,e(t.datapoints,o,C(t.points,t.color),0,!1,t.xaxis,t.yaxis,r),V.restore()}function _(t,e,i,n,o,r,a,s,l,h,u,c){var p,d,f,m;u?(m=d=f=!0,p=!1,u=i,i=e+n,o=e+o,u>t&&(e=t,t=u,u=e,p=!0,d=!1)):(p=d=f=!0,m=!1,u=t+n,t+=o,o=i,i=e,o>i&&(e=i,i=o,o=e,m=!0,f=!1)),s.min>t||u>s.max||l.min>i||o>l.max||(s.min>u&&(u=s.min,p=!1),t>s.max&&(t=s.max,d=!1),l.min>o&&(o=l.min,m=!1),i>l.max&&(i=l.max,f=!1),u=s.p2c(u),o=l.p2c(o),t=s.p2c(t),i=l.p2c(i),a&&(h.beginPath(),h.moveTo(u,o),h.lineTo(u,i),h.lineTo(t,i),h.lineTo(t,o),h.fillStyle=a(o,i),h.fill()),c>0&&(p||d||f||m)&&(h.beginPath(),h.moveTo(u,o+r),p?h.lineTo(u,i+r):h.moveTo(u,i+r),f?h.lineTo(t,i+r):h.moveTo(t,i+r),d?h.lineTo(t,o+r):h.moveTo(t,o+r),m?h.lineTo(u,o+r):h.moveTo(u,o+r),h.stroke()))}function M(t){V.save(),V.translate(Y.left,Y.top),V.lineWidth=t.bars.lineWidth,V.strokeStyle=t.color;var e;switch(t.bars.align){case"left":e=0;break;case"right":e=-t.bars.barWidth;break;case"center":e=-t.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+t.bars.align)}var i=t.datapoints,n=e;e+=t.bars.barWidth;for(var o=t.bars.fill?function(e,i){return C(t.bars,t.color,e,i)}:null,r=t.xaxis,a=t.yaxis,s=i.points,i=i.pointsize,l=0;s.length>l;l+=i)null!=s[l]&&_(s[l],s[l+1],s[l+2],n,e,0,o,r,a,V,t.bars.horizontal,t.bars.lineWidth);V.restore()}function C(e,i,n,o){var r=e.fill;return r?e.fillColor?L(e.fillColor,n,o,i):(e=t.color.parse(i),e.a="number"==typeof r?r:.4,e.normalize(),e.toString()):null}function T(t){N.grid.hoverable&&W("plothover",t,function(t){return!1!=t.hoverable})}function S(t){N.grid.hoverable&&W("plothover",t,function(){return!1})}function I(t){W("plotclick",t,function(t){return!1!=t.clickable})}function W(t,i,n){var o=R.offset(),r=i.pageX-o.left-Y.left,a=i.pageY-o.top-Y.top,s=h({left:r,top:a});s.pageX=i.pageX,s.pageY=i.pageY;var l,u,i=N.grid.mouseActiveRadius,c=i*i+1,p=null;for(l=B.length-1;l>=0;--l)if(n(B[l])){var d=B[l],f=d.xaxis,m=d.yaxis,g=d.datapoints.points,x=d.datapoints.pointsize,y=f.c2p(r),v=m.c2p(a),b=i/f.scale,k=i/m.scale;
if(f.options.inverseTransform&&(b=Number.MAX_VALUE),m.options.inverseTransform&&(k=Number.MAX_VALUE),d.lines.show||d.points.show)for(u=0;g.length>u;u+=x){var w=g[u],_=g[u+1];null==w||w-y>b||-b>w-y||_-v>k||-k>_-v||(w=Math.abs(f.p2c(w)-r),_=Math.abs(m.p2c(_)-a),_=w*w+_*_,c>_&&(c=_,p=[l,u/x]))}if(d.bars.show&&!p)for(f="left"==d.bars.align?0:-d.bars.barWidth/2,d=f+d.bars.barWidth,u=0;g.length>u;u+=x)w=g[u],_=g[u+1],m=g[u+2],null!=w&&(B[l].bars.horizontal?Math.max(m,w)>=y&&y>=Math.min(m,w)&&v>=_+f&&_+d>=v:y>=w+f&&w+d>=y&&v>=Math.min(m,_)&&Math.max(m,_)>=v)&&(p=[l,u/x])}if(p?(l=p[0],u=p[1],x=B[l].datapoints.pointsize,n={datapoint:B[l].datapoints.points.slice(u*x,(u+1)*x),dataIndex:u,series:B[l],seriesIndex:l}):n=null,n&&(n.pageX=parseInt(n.series.xaxis.p2c(n.datapoint[0])+o.left+Y.left),n.pageY=parseInt(n.series.yaxis.p2c(n.datapoint[1])+o.top+Y.top)),N.grid.autoHighlight){for(o=0;ie.length>o;++o)r=ie[o],!(r.auto!=t||n&&r.series==n.series&&r.point[0]==n.datapoint[0]&&r.point[1]==n.datapoint[1]||!E(r.series,r.point));n&&P(n.series,n.datapoint,t)}e.trigger(t,[s,n])}function z(){var t=N.interaction.redrawOverlayInterval;-1==t?A():ne||(ne=setTimeout(A,t))}function A(){ne=null,G.save(),G.clearRect(0,0,j,U),G.translate(Y.left,Y.top);var e,i;for(e=0;ie.length>e;++e)if(i=ie[e],i.series.bars.show)F(i.series,i.point);else{var n=i.series,o=i.point;i=o[0];var o=o[1],a=n.xaxis,s=n.yaxis;if(highlightColor="string"==typeof n.highlightColor?n.highlightColor:t.color.parse(n.color).scale("a",.5).toString(),!(a.min>i||i>a.max||s.min>o||o>s.max)){var l=n.points.radius+n.points.lineWidth/2;G.lineWidth=l,G.strokeStyle=highlightColor,l*=1.5,i=a.p2c(i),o=s.p2c(o),G.beginPath(),"circle"==n.points.symbol?G.arc(i,o,l,0,2*Math.PI,!1):n.points.symbol(G,i,o,l,!1),G.closePath(),G.stroke()}}G.restore(),r($.drawOverlay,[G])}function P(t,e,i){if("number"==typeof t&&(t=B[t]),"number"==typeof e)var n=t.datapoints.pointsize,e=t.datapoints.points.slice(n*e,n*(e+1));n=D(t,e),-1==n?(ie.push({series:t,point:e,auto:i}),z()):i||(ie[n].auto=!1)}function E(t,e){null==t&&null==e&&(ie=[],z()),"number"==typeof t&&(t=B[t]),"number"==typeof e&&(e=t.data[e]);var i=D(t,e);-1!=i&&(ie.splice(i,1),z())}function D(t,e){for(var i=0;ie.length>i;++i){var n=ie[i];if(n.series==t&&n.point[0]==e[0]&&n.point[1]==e[1])return i}return-1}function F(e,i){var n="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString(),o="left"==e.bars.align?0:-e.bars.barWidth/2;G.lineWidth=e.bars.lineWidth,G.strokeStyle=n,_(i[0],i[1],i[2]||0,o,o+e.bars.barWidth,0,function(){return n},e.xaxis,e.yaxis,G,e.bars.horizontal,e.bars.lineWidth)}function L(e,i,n,o){if("string"==typeof e)return e;for(var i=V.createLinearGradient(0,n,0,i),n=0,r=e.colors.length;r>n;++n){var a=e.colors[n];if("string"!=typeof a){var s=t.color.parse(o);null!=a.brightness&&(s=s.scale("rgb",a.brightness)),null!=a.opacity&&(s.a*=a.opacity),a=s.toString()}i.addColorStop(n/(r-1),a)}return i}var B=[],N={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,timezone:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:!1},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},H=null,O=null,R=null,V=null,G=null,X=[],q=[],Y={left:0,right:0,top:0,bottom:0},j=0,U=0,Q=0,J=0,$={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},K=this;K.setData=a,K.setupGrid=g,K.draw=x,K.getPlaceholder=function(){return e},K.getCanvas=function(){return H},K.getPlotOffset=function(){return Y},K.width=function(){return Q},K.height=function(){return J},K.offset=function(){var t=R.offset();return t.left+=Y.left,t.top+=Y.top,t},K.getData=function(){return B},K.getAxes=function(){var e={};return t.each(X.concat(q),function(t,i){i&&(e[i.direction+(1!=i.n?i.n:"")+"axis"]=i)}),e},K.getXAxes=function(){return X},K.getYAxes=function(){return q},K.c2p=h,K.p2c=function(t){var e,i,n,o={};for(e=0;X.length>e;++e)if((i=X[e])&&i.used&&(n="x"+i.n,null==t[n]&&1==i.n&&(n="x"),null!=t[n])){o.left=i.p2c(t[n]);break}for(e=0;q.length>e;++e)if((i=q[e])&&i.used&&(n="y"+i.n,null==t[n]&&1==i.n&&(n="y"),null!=t[n])){o.top=i.p2c(t[n]);break}return o},K.getOptions=function(){return N},K.highlight=P,K.unhighlight=E,K.triggerRedrawOverlay=z,K.pointOffset=function(t){return{left:parseInt(X[s(t,"x")-1].p2c(+t.x)+Y.left),top:parseInt(q[s(t,"y")-1].p2c(+t.y)+Y.top)}},K.shutdown=function(){ne&&clearTimeout(ne),R.unbind("mousemove",T),R.unbind("mouseleave",S),R.unbind("click",I),r($.shutdown,[R])},K.resize=function(){d(),f(H),f(O)},K.hooks=$;for(var Z=0;o.length>Z;++Z){var te=o[Z];te.init(K),te.options&&t.extend(!0,N,te.options)}for(t.extend(!0,N,n),null==N.xaxis.color&&(N.xaxis.color=N.grid.color),null==N.yaxis.color&&(N.yaxis.color=N.grid.color),null==N.xaxis.tickColor&&(N.xaxis.tickColor=N.grid.tickColor),null==N.yaxis.tickColor&&(N.yaxis.tickColor=N.grid.tickColor),null==N.grid.borderColor&&(N.grid.borderColor=N.grid.color),null==N.grid.tickColor&&(N.grid.tickColor=t.color.parse(N.grid.color).scale("a",.22).toString()),n=0;Math.max(1,N.xaxes.length)>n;++n)N.xaxes[n]=t.extend(!0,{},N.xaxis,N.xaxes[n]);for(n=0;Math.max(1,N.yaxes.length)>n;++n)N.yaxes[n]=t.extend(!0,{},N.yaxis,N.yaxes[n]);for(N.xaxis.noTicks&&null==N.xaxis.ticks&&(N.xaxis.ticks=N.xaxis.noTicks),N.yaxis.noTicks&&null==N.yaxis.ticks&&(N.yaxis.ticks=N.yaxis.noTicks),N.x2axis&&(N.xaxes[1]=t.extend(!0,{},N.xaxis,N.x2axis),N.xaxes[1].position="top"),N.y2axis&&(N.yaxes[1]=t.extend(!0,{},N.yaxis,N.y2axis),N.yaxes[1].position="right"),N.grid.coloredAreas&&(N.grid.markings=N.grid.coloredAreas),N.grid.coloredAreasColor&&(N.grid.markingsColor=N.grid.coloredAreasColor),N.lines&&t.extend(!0,N.series.lines,N.lines),N.points&&t.extend(!0,N.series.points,N.points),N.bars&&t.extend(!0,N.series.bars,N.bars),null!=N.shadowSize&&(N.series.shadowSize=N.shadowSize),null!=N.highlightColor&&(N.series.highlightColor=N.highlightColor),n=0;N.xaxes.length>n;++n)u(X,n+1).options=N.xaxes[n];for(n=0;N.yaxes.length>n;++n)u(q,n+1).options=N.yaxes[n];for(var ee in $)N.hooks[ee]&&N.hooks[ee].length&&($[ee]=$[ee].concat(N.hooks[ee]));r($.processOptions,[N]),ee=e.children("canvas.flot-base"),n=e.children("canvas.flot-overlay"),0==ee.length||0==n?(e.html(""),e.css({padding:0}),"static"==e.css("position")&&e.css("position","relative"),d(),H=p(!0,"flot-base"),O=p(!1,"flot-overlay"),ee=!1):(H=ee.get(0),O=n.get(0),ee=!0),V=H.getContext("2d"),G=O.getContext("2d"),R=t(O),ee&&(e.data("plot").shutdown(),K.resize(),G.clearRect(0,0,j,U),R.unbind(),e.children().not([H,O]).remove()),e.data("plot",K),a(i),g(),x(),N.grid.hoverable&&(R.mousemove(T),R.mouseleave(S)),N.grid.clickable&&R.click(I),r($.bindEvents,[R]);var ie=[],ne=null}t.plot=function(i,n,o){return new e(t(i),n,o,t.plot.plugins)},t.plot.version="0.7",t.plot.plugins=[]}(jQuery),function(){this.SpeedGraph=function(){function t(t,e,i){this.api=t,this.element=e,this.options=i}return t.prototype.load=function(t){var e,i;return e=0,i=[],this.data=t.map(function(t){return t.sog>e&&(e=t.sog+.1),t.wind_speed>e&&(e=t.wind_speed+.1),i.push([t.time.getTime(),t.wind_speed]),[t.time.getTime(),t.sog]}),this.wind_bg={data:i.slice(0,i.length),color:"#CCC",lines:{show:!0,fill:!0,fillColor:"#CCC"},shadowSize:0},this.pre={data:this.data.slice(0,this.data.length),color:this.options.colour,lines:{show:!0,fill:!0,fillColor:this.options.colour},shadowSize:0},this.post={data:[],color:"#999",lines:{show:!0,fill:!0,fillColor:"#999"},shadowSize:0},this.wind_line={data:i.slice(0,i.length),color:"#666",lines:{show:!0,fill:!1,fillColor:"#666"},shadowSize:0},this.plot=this.api(this.element,[this.wind_bg,this.pre,this.post,this.wind_line],{xaxis:{show:!1},yaxis:{show:!1,min:0,max:Math.ceil(e)},grid:{show:!1}})},t.prototype.set=function(t){return this.pre.data=this.data.slice(0,t),this.post.data=this.data.slice(t,this.data.length),this.plot.setData([this.wind_bg,this.pre,this.post,this.wind_line]),this.plot.draw()},t}()}.call(this),function(){var t;t=function(){function t(t,e,i){var n,o=this;this.course=t,this.map=e,null==i&&(i=CourseDisplay.Mark),n={},this.marks=this.course.marks.map(function(t){var e;return e=t.lat+"_"+t.lng,n[e]||(n[e]=new i(t,o.map),n[e]),n[e]})}return t.prototype.update=function(){var t=this;return this.line.setPath([]),this.marks.forEach(function(e){return t.line.getPath().push(e.position())})},t.prototype.load=function(t){return this.course.load(t),this.line=this.map.line({strokeColor:"rgba(0,0,0,0.2)",zIndex:-1}),this.update()},t.prototype.set=function(t){var e;return e=this.course.next_mark_at(t),this.marks.forEach(function(t){return t.actual===e?t.active_icon():t.default_icon()})},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).CourseDisplay=t}.call(this),function(){var t,e;t=function(){function t(t,i){this.actual=t,this.map_api=i,this.ui=this.map_api.mark(this.actual.lat,this.actual.lng,{title:e(this.actual.lat,this.actual.lng)})}var e;return e=function(t,e){return"Port hand mark at "+t.toFixed(3)+","+e.toFixed(3)},t.prototype.default_icon=function(){return this.ui.setIcon(this.map_api.icon("/images/p_mrk_s.png",{anchor:[5,6]}))},t.prototype.active_icon=function(){return this.ui.setIcon(this.map_api.icon("/images/p_mrk_s_a.png",{anchor:[5,6]}))},t.prototype.position=function(){return this.ui.getPosition()},t.prototype.make_editable=function(){return this.ui.setDraggable(!0)},t.prototype.make_fixed=function(){return this.ui.setDraggable(!1)},t}(),(e="undefined"!=typeof exports&&null!==exports?exports:this).CourseDisplay||(e.CourseDisplay={}),("undefined"!=typeof exports&&null!==exports?exports:this).CourseDisplay.Mark=t}.call(this),function(){var t,e,i=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){function t(t,e){var n,o=this;this.display=t,this.mark_klass=null!=e?e:CourseDisplay.Mark,this.edit_mark=i(this.edit_mark,this),n=this.display.map,n.on("click",null,function(t){var e;return e=new o.mark_klass(t,n),o.edit_mark(e,n),o.display.marks.push(e),o.display.update()}),this.display.marks.forEach(function(t){return o.edit_mark(t,o.display.map)})}return t.prototype.edit_mark=function(t,e){return t.make_editable(),e.on("click",t,this.click_mark(this.display,t)),e.on("drag",t,this.drag_mark(this.display))},t.prototype.drag_mark=function(t){return function(){return t.update()}},t.prototype.click_mark=function(t,e){return function(){return t.marks.push(e),t.update()}},t.prototype.load=function(t){return this.display.load(t)},t.prototype.set=function(t){return this.display.set(t)},t}(),(e="undefined"!=typeof exports&&null!==exports?exports:this).CourseDisplay||(e.CourseDisplay={}),("undefined"!=typeof exports&&null!==exports?exports:this).CourseDisplay.Editable=t}.call(this),function(){var t;t=function(){function t(t,e,i,n){var o=this;this.output=e,null==i&&(i="blue"),this.calc=null!=n?n:DistanceBetween,this.last_point=void 0,this.points=t.map(function(t){var e;return e=o.last_point?new o.calc(o.last_point,{lat:t.coords[0],lng:t.coords[1]}).to_nm():0,o.last_point={time:new Date(t.time),lat:t.coords[0],lng:t.coords[1],cog:t.course[0],sog:t.course[1],distance_since_last:e,wind_speed:t.wind_speed,wind_bearing:t.wind_bearing}}),this.output.forEach(function(t){return t.load(o.points,{colour:i})})}return t.prototype.start_time=function(){return this.points[0].time},t.prototype.finish_time=function(){return this.points[this.points.length-1].time},t.prototype.total_time=function(){return(this.finish_time()-this.start_time())/1e3},t.prototype.total_distance=function(){var t,e,i,n,o;for(t=0,o=this.points,i=0,n=o.length;n>i;i++)e=o[i],t+=e.distance_since_last;return t},t.prototype.average_speed=function(){return this.total_distance()/(this.total_time()/60/60)},t.prototype.set_to=function(t){var e,i,n,o,r,a,s;for(n=t.time_from(this.start_time()),i=0,s=this.points,e=r=0,a=s.length;a>r&&(o=s[e],!(o.time>n));e=++r)i=e;return this.output.map(function(t){return t.set(i+1)})},t}(),("undefined"!=typeof exports&&null!==exports?exports:this).TrackPlayer=t}.call(this);